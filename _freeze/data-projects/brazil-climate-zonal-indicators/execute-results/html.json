{
  "hash": "9907b560575f1d8ae446d3ed9e6e5082",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Zonal statistics of climate indicators for Brazilian municipalities\"\nbibliography: references.bib\n---\n\n\n\n\n![](images/zonal_brdwgd-01.png)\n\n## Introduction\n\nClimate indicators are used on several statistical models for many research areas and are specially important for modeling Climate Sensitive Diseases (CSD) incidence. Those models usually adopts a lattice structure, where its data is aggregated at administrative boundaries (e.g. disease incidence), but climate indicators are usually presented in a continuous regular grid format.\n\nTo make climate indicators compatible with lattice structures, zonal statistics may be adopted. Zonal statistics are descriptive statistics calculated using a set of cells that spatially intersects a given spatial boundary. For each boundary in a map, statistics like average, maximum value, minimum value, standard deviation, and sum are obtained to represent the cell's values that intersect the boundary.\n\nI created some zonal statistics of climate indicators datasets for Brazilian municipalities from some climate data products.\n\n## Zonal ERA5-Land\n\n1950-2022: [![](https://img.shields.io/badge/download-10.5281/zenodo.10036211-green.svg)](https://doi.org/10.5281/zenodo.10036211)\n\n2023: [![](https://img.shields.io/badge/download-10.5281/zenodo.10947952-green.svg)](https://doi.org/10.5281/zenodo.10947952)\n\n2024: [![](https://img.shields.io/badge/download-10.5281/zenodo.15748125-green.svg)](https://doi.org/10.5281/zenodo.15748125)\n\nThe ERA5-Land data [@muñoz-sabater2021] presents hourly climate indicators at 0.1° × 0.1° horizontal resolution with global coverage, from 1950 to present.\n\nSelected indicators hourly data were [downloaded and aggregated at daily basis](http://localhost:6732/data-projects/era5land-daily-latin-america.html) to compute zonal statistics for the Brazilian municipalities.\n\nThe following indicators and aggregations were computed.\n\n| ERA5-Land indicators | Daily time-aggregating functions | Spatial zonal statistics |\n|--------------------|----------------------------|------------------------|\n| Temperature (2m) | mean, max, min | max, min, stdev, count |\n| Dewpoint temp. (2m) | mean | max, min, stdev, count |\n| $u$ component of wind | mean | max, min, stdev, count |\n| $v$ component of wind | mean | max, min, stdev, count |\n| Surface pressure | mean | max, min, stdev, count |\n| Total precipitation | sum | max, min, stdev, count, sum |\n\nA paper with the full methodology was published in the Environmental Data Science journal.\n\n[![](https://zenodo.org/badge/DOI/10.1017/eds.2024.3.svg)](https://doi.org/10.1017/eds.2024.3)\n\n::: callout-tip\nThose files are in parquet format. Not sure how to open parquet files? Take a look on this [blog post](https://rfsaldanha.github.io/posts/query_local_parquet_files.html).\n:::\n\n### Usage statistics\n\nUsage statistics of this and other datasets are available [here](https://rfsaldanha.github.io/pkgdash/#datasets).\n\n## Zonal BR-DWGD\n\n1961-01-01 to 2024-03-20: [![](https://img.shields.io/badge/download-10.5281/zenodo.13906834-green.svg)](https://doi.org/10.5281/zenodo.13906834)\n\nThe BR-DWGD dataset [@xavier2022] presents daily meteorological data interpolated to a grid with 0.1° × 0.1° of spatial resolution for the Brazilian territory, with daily data starting on January 1, 1961. It uses data from several weather stations rain gauges in its interpolation methods, cross-validated to the selection of the best method for each weather indicator.\n\nThe following weather indicators are available from the BR-DWGD study: precipitation (mm), minimum temperature (°C), maximum temperature (°C), solar radiation (MJ⋅m−2 ), wind speed at 2m height (m⋅s−1) and relative humidity (%).\n\nThe following zonal statistics were computed.\n\n| BR-DGWD indicators | Daily time-aggregating functions | Spatial zonal statistics |\n|--------------------|----------------------------|------------------------|\n| Temperature | max, min | max, min, stdev, count |\n| Relative humidity | mean | max, min, stdev, count |\n| $u$ component of wind | mean | max, min, stdev, count |\n| Evapotranspiration | mean | max, min, stdev, count |\n| Solar radiation | mean | max, min, stdev, count |\n| Precipitation | sum | max, min, stdev, count, sum |\n\n::: callout-tip\nThose files are in parquet format. Not sure how to open parquet files? Take a look on this [blog post](https://rfsaldanha.github.io/posts/query_local_parquet_files.html).\n:::\n\n## Zonal TerraClimate\n\n[![](https://img.shields.io/badge/download-10.5281/zenodo.7825777-green.svg)](https://doi.org/10.5281/zenodo.7825777)\n\nThe TerraClimate [@abatzoglou2018] dataset presents monthly meteorological data interpolated to a grid with 0.04° × 0.04° (1/24th degree) of spatial resolution with world cover, with monthly data from January, 1958, to December, 2021.\n\nThe following weather indicators are available from the TerraClimate study: Actual Evapotranspiration (mm), Climate Water Deficit (mm), Potential evapotranspiration(mm), Precipitation (mm), Runoff (mm), Soil Moisture (mm), Downward surface shortwave radiation (W/m2), Snow water equivalent (mm), Minimum temperature (°C), Maximum temperature (°C), Vapor pressure (kPa), Wind speed (m/s), Vapor Pressure Deficit (kpa) and Palmer Drought Severity Index.\n\nThe following zonal statistics were computed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrclimr::product_info(product = \"terraclimate\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<list>\n├─tmax: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Maximum temperature\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"°C\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"tmax_min\"\n│   ├─max: \"tmax_max\"\n│   ├─mean: \"tmax_mean\"\n│   └─sd: \"tmax_sd\"\n├─tmin: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Minimum temperature\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"°C\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"tmin_min\"\n│   ├─max: \"tmin_max\"\n│   ├─mean: \"tmin_mean\"\n│   └─sd: \"tmin_sd\"\n├─ppt: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Precipitation\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"ppt_min\"\n│   ├─max: \"ppt_max\"\n│   ├─mean: \"ppt_mean\"\n│   ├─sd: \"ppt_sd\"\n│   └─sum: \"ppt_sum\"\n├─aet: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Actual Evapotranspiration\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"aet_min\"\n│   ├─max: \"aet_max\"\n│   ├─mean: \"aet_mean\"\n│   ├─sd: \"aet_sd\"\n│   └─sum: \"aet_sum\"\n├─def: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Climate Water Deficit\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"def_min\"\n│   ├─max: \"def_max\"\n│   ├─mean: \"def_mean\"\n│   ├─sd: \"def_sd\"\n│   └─sum: \"def_sum\"\n├─pdsi: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Palmer Drought Severity Index\"\n│ ├─detail: \"At end of month\"\n│ ├─unit: \"unitless\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"PDSI_min\"\n│   ├─max: \"PDSI_max\"\n│   ├─mean: \"PDSI_mean\"\n│   └─sd: \"PDSI_sd\"\n├─pet: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Potential evapotranspiration\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"pet_min\"\n│   ├─max: \"pet_max\"\n│   ├─mean: \"pet_mean\"\n│   ├─sd: \"pet_sd\"\n│   └─sum: \"pet_sum\"\n├─q: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Runoff\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"q_min\"\n│   ├─max: \"q_max\"\n│   ├─mean: \"q_mean\"\n│   ├─sd: \"q_sd\"\n│   └─sum: \"q_sum\"\n├─soil: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Soil Moisture\"\n│ ├─detail: \"Total column, at end of month\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"soil_min\"\n│   ├─max: \"soil_max\"\n│   ├─mean: \"soil_mean\"\n│   ├─sd: \"soil_sd\"\n│   └─sum: \"soil_sum\"\n├─srad: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Downward surface shortwave radia...\"\n│ ├─unit: \"W/m2\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"srad_min\"\n│   ├─max: \"srad_max\"\n│   ├─mean: \"srad_mean\"\n│   ├─sd: \"srad_sd\"\n│   └─sum: \"srad_sum\"\n├─swe: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Snow water equivalent\"\n│ ├─detail: \"At end of month\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"swe_min\"\n│   ├─max: \"swe_max\"\n│   ├─mean: \"swe_mean\"\n│   ├─sd: \"swe_sd\"\n│   └─sum: \"swe_sum\"\n├─vap: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Vapor pressure\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"kPa\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"vap_min\"\n│   ├─max: \"vap_max\"\n│   ├─mean: \"vap_mean\"\n│   └─sd: \"vap_sd\"\n├─vpd: <list>\n│ ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n│ ├─name: \"Vapor Pressure Deficit\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"kPa\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"vpd_min\"\n│   ├─max: \"vpd_max\"\n│   ├─mean: \"vpd_mean\"\n│   └─sd: \"vpd_sd\"\n└─ws: <list>\n  ├─link: \"https://terraclimate.nyc3.cdn.di...\"\n  ├─name: \"Wind speed\"\n  ├─detail: \"Average for month\"\n  ├─unit: \"m/s\"\n  ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n  └─stats: <list>\n    ├─min: \"ws_min\"\n    ├─max: \"ws_max\"\n    ├─mean: \"ws_mean\"\n    └─sd: \"ws_sd\"\n```\n\n\n:::\n:::\n\n\n\n\nThe results are availabe as parquet files, available at [Zenodo](https://zenodo.org/records/7825777) and can be also accessed with the [brclimr](https://rfsaldanha.github.io/brclimr) R package.\n\n::: callout-tip\nThose files are in parquet format. Not sure how to open parquet files? Take a look on this [blog post](https://rfsaldanha.github.io/posts/query_local_parquet_files.html).\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}