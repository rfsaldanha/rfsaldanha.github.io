{
  "hash": "3025340852e4e6126c8b8aead59139f2",
  "result": {
    "markdown": "---\ntitle: \"How 2023 was hot in different Brazilian municipalities?\"\ndate: \"2023-11-27\"\ncategories: [climate, zonal statistics]\n---\n\n\nAccording to the [last Copernicus report](https://climate.copernicus.eu/copernicus-october-2023-exceptional-temperature-anomalies-2023-virtually-certain-be-warmest-year), 2023 was exceptional hot year. The image bellow from this report circulated a lot at the social media.\n\n![](images/era5_daily_sst_60S-60N_1979-2023_dark.png)\n\nClearly, 2023 temperatures are the highest in comparison to other years and the temperature difference to the previous years is unmatched.\n\nIt is important to comprehend that this graph used data from all the globe surface, including the oceans, giving us an overall picture. At some places this temperature anomaly may be different, with weaker or even stronger differences.\n\n**But how are 2023 temperatures at the local level, where I live?**\n\nTo answer this question, first we need to have specific data by location. One way to produce this specific data is with *zonal statistics*.\n\n::: callout-note\nZonal statistics is a operation where statistics are computed for a set of cell values that intersects a given spatial boundary.\n:::\n\nI created a dataset with [zonal statistics for the Brazilian municipalities](../data-projects/era5land-daily-latin-america.qmd), with data from 1950 to 2022 using data from the ERA5-Land reanalysis.\n\nThus, to make similar graphs to Brazilian municipalities, I used the same methodology with the available 2023 ERA5-Land data (from January to October).\n\nThe data is ready, let's make some plots! First, load the necessary packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(arrow)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(timetk)\nlibrary(ggplot2)\nlibrary(directlabels)\nlibrary(viridis)\nlibrary(ggdark)\n```\n:::\n\n\nNow, we will read the data from the 1950-2022 period. This parquet file is available to download at [Zenodo](../data-projects/era5land-daily-latin-america.qmd) with daily data to all Brazilian municipalities, from 1950 to 2022.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp <- open_dataset(sources = \"../../brclim2/output_data/parquet/2m_temperature_mean.parquet\") %>% #<1>\n  filter(name == \"2m_temperature_mean_mean\") %>% #<2>\n  filter(date >= as.Date(\"1990-01-01\")) %>% #<3>\n  collect() %>% #<4>\n  mutate(\n    year = year(date), #<5>\n    date = update(date, year = 2023), #<6>\n    value = value - 273.15 #<7>\n  )\n```\n:::\n\n\n1.  Open the parquet dataset without loading it all to the memory.\n2.  Filter the desired indicator, on this case, the average temperature.\n3.  Keep the data only after 1990 to produce a cleaner graph.\n4.  Collect the data from the parquet file to memory.\n5.  Create a new variable with the year.\n6.  Change the year of all dates to 2023. This will make easer to overlay the time series of each year.\n7.  The original values are in Kelvin. Let's convert it to Celsius Degrees.\n\nAnd now load the 2023 data. I will share this parquet file later...\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp_23 <- open_dataset(sources = \"../../brclim2/output_data/data_2023/parquet/2m_temperature_mean.parquet\") %>%\n  filter(name == \"2m_temperature_mean_mean\") %>%\n  collect() %>%\n  mutate(value = value - 273.15)\n```\n:::\n\n\nTo make a graph, we can set a municipality code for reference (e.g. Rio de Janeiro, RJ) and create a list object with all the necessary data. Then, we create a simple and nice ggplot ;-)\n\n\n::: {.cell .preview-image}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3304557\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Rio de Janeiro, RJ\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n::: callout-tip\nI choose to use a LOESS smooth because the original daily data is very noise, making harder to see the general trends.\n:::\n\nFollowing the global trend, the temperature at Rio Janeiro, RJ at 2023 has been exceptional hot after September.\n\nBellow, the same plot for the Brazilian capitals and some selected municipalities. You will see that at some municipalities the 2023 temperatures are higher than other years, but at some others places the values are lower. This is the climate change effect, leading climate indicators to different extremes, increasing its variabilities.\n\n## Porto Velho, RO\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1100205\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Porto Velho, RO\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Manaus, AM\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1302603\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Manaus, AM\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Rio Branco, AC\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1200401\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Rio Branco, AC\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Campo Grande, MS\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 5002704\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Campo Grande, MS\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Macapá, AP\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1600303\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Macapá, AP\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Brasília, DF\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 5300108\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Brasília, DF\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## Boa Vista, RR\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1400100\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Boa Vista, RR\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Cuiabá, MT\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 5103403\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Cuiabá, MT\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Palmas, TO\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1721000\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Palmas, TO\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## São Paulo, SP\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3550308\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"São Paulo, SP\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Teresina, PI\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2211001\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Teresina, PI\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Rio de Janeiro, RJ\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3304557\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Rio de Janeiro, RJ\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Belém, PA\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 1501402\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Belém, PA\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## Goiânia, GO\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 5208707\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Goiânia, GO\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Salvador, BA\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2927408\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Salvador, BA\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## Florianópolis, SC\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 4205407\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Florianópolis, SC\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n## São Luiz, MA\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2111300\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"São Luiz, MA\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n## Maceió, AL\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2704302\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Maceió, AL\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n## Porto Alegre, RS\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 4314902\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Porto Alegre, RS\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n## Curitiba, PR\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 4106902\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Curitiba, PR\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n## Belo Horizonte, MG\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3106200\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Belo Horizonte, MG\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n## Fortaleza, CE\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2304400\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Fortaleza, CE\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n## Recife, PE\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2611606\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Recife, PE\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n## João Pessoa, PB\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2507507\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"João Pessoa, PB\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n## Aracaju, SE\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2800308\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Aracaju, SE\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n## Natal, RN\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 2408102\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Natal, RN\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n## Vitória, ES\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3205309\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Vitória, ES\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n## Nova Friburgo, RJ\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3303401\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Nova Friburgo, RJ\", \n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n## Juiz de Fora, MG\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncode_ref <- 3136702\n\ntemp_list <- list(\n  temp = temp %>% filter(code_muni == code_ref),\n  temp_23 = temp_23 %>% filter(code_muni == code_ref)\n)\n\nggplot() +\n  geom_line(\n    data = temp_list$temp, \n    aes(x = date, y = value, color = year, group = year),\n    alpha = .3, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n  scale_color_viridis(option = \"plasma\") +\n  geom_line(\n    data = temp_list$temp_23, \n    aes(x = date, y = value), \n    color = \"red\",\n    lwd = 1, alpha = .7, \n    stat = \"smooth\", \n    method = \"loess\"\n  ) +\n    geom_dl(\n    data = temp_list$temp_23, \n    aes(x = date, y = value, label = \"2023\"),\n    method = list(dl.combine(\"last.points\")), \n    color = \"red\",\n    cex = 0.8\n  ) +\n  ylim(15, 35) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%b\") +\n  dark_theme_gray() +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  ) +\n  labs(\n    title = \"Juiz de Fora, MG\",\n    x = \"Date\",\n    y = \"Average temperature (°C)\", \n    color = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](hot_2023_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "hot_2023_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}