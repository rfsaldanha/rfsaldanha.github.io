---
title: "Democratização de acesso a dados de saúde, ambiente e clima com o R"
subtitle: "a experiência do LIS/ICICT/Fiocruz"
author: "Raphael Saldanha"
institute: "Fiocruz"
date: "2025-08-04"
#description: ""
categories: [climate]
#image: images/subsets_model_accuracy.png
format:
  revealjs: 
    theme: icict_style.scss
    logo: images/logo_icict_6.png
    transition: fade
    background-transition: fade
    pointer:
      pointerSize: 40
      color: '#e63312'
code-link: true
revealjs-plugins:
  - pointer
---

## Raphael Saldanha

::::: columns
::: {.column width="55%"}
-   Geógrafo (UFJF)
-   Especialista em Métodos Estatísticos Computacionais (UFJF)
-   Mestre em Saúde Coletiva (UFJF)
-   Doutor em Informação e Comunicação em Saúde (Fiocruz)
:::

::: {.column width="45%"}
-  Assistente de pesquisa na Fiocruz
-  Observatório de Clima e Saúde
-  Plataforma de Ciência de Dados Aplicada à Saúde (PCDaS)
:::
:::::

## Raphael Saldanha e o R

::::: columns
::: {.column width="55%"}
-   R 2.1 (2005)
-   Lembra do Tinn-R?
-   Desenvolvedor de pacotes, painéis e conjuntos de dados de clima, ambiente e saúde
:::

::: {.column width="45%"}
-   {microdatasus}
-   {brpop}
-   {nseq} e outros
:::
:::::

## {microdatasus}

-   Início: Maio de 2017 (8 anos)
-   Facilitar o acesso e processamento de dados dos Sistemas de Informação em Saúde do Brasil
-   Dados de nascimentos, mortalidade, internações hospitalares, procedimentos ambulatoriais, casos suspeitos de doenças e outros

## {microdatasus}

-   Formato legado de arquivo: DBC (versão compactada do DBF)
-   Download de dados em servidor FTP
-   Dados sem rótulos
-   Aplicativo oficial: TabWin (apenas para Windows)
-   Necessidade de integrar o processo de acesso e pré-processamento dos dados em um único ambiente (R)

## {microdatasus}

-   Download de dados: função `fetch_datasus()`
-   Pré-processamento: família de funções `process_sim()`, `process_sinasc()`, `process_*()`

## {microdatasus}

```{r}
#| echo: true
library(microdatasus)

raw_data <- fetch_datasus(
  year_start = 2022,
  year_end = 2023,
  uf = "ES",
  information_system = "SIM-DO"
)

tibble::tibble(raw_data)
```

## {microdatasus}

```{r}
#| echo: true
p_data <- process_sim(raw_data)

tibble::tibble(p_data)
```

##  {.big_text .center data-menu-title="{microdatasus}"}

::: big_text
https://rfsaldanha.github.io/
microdatasus
:::

## 

![](../talks/images/microdatasus_testimonials.png)

## {microdatasus}

-   Agradecimentos a Daniela Petruzalek, pacote {read.dbc}
-   165 menções no Google Scholar
-   Issues: [https://github.com/rfsaldanha/microdatasus/issues](https://github.com/rfsaldanha/microdatasus/issues)
-   Artigo na [Cadernos de Saúde Pública](https://doi.org/10.1590/0102-311x00032419)
-   Capítulo no livro [Avaliação de impacto das políticas públicas de saúde: um guia para o SUS](https://avaliasus.org)
-   Lançamento de um curso em breve...

## Pandemia: MonitoraCovid-19

-   Cenário de chegada da Covid-19 no Brasil
-   Simulação de cenários de casos e óbitos
-   Dificuldade com dados oficiais, apagão de dados
-   Importante parceiro: brasil.io (Turicas)
-   Informar o gestor e o cidadão em uma realidade de negacionismo científico

## MonitoraCovid-19

-   Painel em R Shiny
-   Uma das respostas institucionais da Fiocruz frente a pandemia
-   Monitoramento da situação da pandemia além de casos e óbitos
-   Circulação de pessoas, vacinação, medidas de combate...
-   Mais de 10 fontes de dados
-   Impacto nacional e internacional

## 

![](../talks/images/monitoracovid19.png)

## MonitoraCovid-19

-   Frontend e backend 
-   Atualização diária de dados (17h)
-   Script manual
-   Script "semi"-automático
-   Saída: arquivo `rdata` para o painel

## MonitoraCovid-19

-   Shiny server local
-   Efeito "Atila Iamarino"
-   Load balancer

![](../talks/images/monitoracovid19_acessos.png)

## MonitoraCovid-19

-   1,025 milhões de acessos
-   324 mil usuários, de todos os continentes
-   793 inserções na mídia
-   38 notas técnicas, comunicações breves e artigos relacionados
-   Premiado pela ENAP
-   Versatilidade do R + Shiny para comunicação científica

## Dados ambientais e climáticos

-   Interface do R com dados geográficos (SIG)
-   Compatibilizar dados de superfície (raster) com dados lattice (limites municipais)
-   Estatísticas zonais

![](../talks/images/zonal_statistics.png)

## 

::::: columns
::: {.column width="50%"}
![](../talks/images/era5-land-daily-aggregates.png)
:::

::: {.column width="50%"}
![](../talks/images/pop_era5_grid_overlay.png)
:::
:::::

## Dados ambientais e climáticos

-   Desafio: dados horários e diários, desde 1950 (ERA5-Land)
-   5.570 municípios
-   Pacote {zonalclim}: [https://rfsaldanha.github.io/zonalclim/](https://rfsaldanha.github.io/zonalclim/)
-  {exactextractr} on steroids
-  Blocos de tarefas computacionais para computação em paralelo

## 

::::: columns
::: {.column width="50%"}
![](../talks/images/tmin_map.png)
:::

::: {.column width="50%"}
![](../talks/images/tmax_map.png)
:::
:::::

## De dados para eventos climáticos

-  Desafio: observar em séries temporais climáticas eventos de interesse
-  Ondas de calor, chuvas persistentes, períodos de seca, anomalias e normais climatológicas...
-  Pacote {climindi}: [https://rfsaldanha.github.io/climindi/](https://rfsaldanha.github.io/climindi/)
-  Pacote {nseq}: [https://rfsaldanha.github.io/nseq/](https://rfsaldanha.github.io/nseq/)

#

![](../talks/images/climindi.png)

## Publicação de conjuntos de dados

-   Agregação diária de indicadores do ERA5-Land para [América Latina](https://rfsaldanha.github.io/data-projects/era5land-daily-latin-america.html) e [África](https://rfsaldanha.github.io/data-projects/era5land-daily-africa.html)
-   [Indicadores de clima](https://rfsaldanha.github.io/data-projects/brazil-climate-zonal-indicators.html) para municípios brasileiros
-   [Indicadores de eventos climáticos](https://rfsaldanha.github.io/data-projects/brazil_climate_normals_indicators.html) para municípios brasileiros
-   [Indicadores de poluição do ar](https://rfsaldanha.github.io/data-projects/brazil_air_pollutants.html) para municípios brasileiros
-   [Espelho S3](https://rfsaldanha.github.io/data-projects/s3-datasus-ftp-mirror.html) do FTP do DataSUS

## Outros pacotes

-   [{brpop}](https://rfsaldanha.github.io/brpop/): Estimativas populacionais
-   [{tidyrates}](https://rfsaldanha.github.io/tidyrates/): *Tidy* taxas padronizadas por idade
-   [{zendown}](https://rfsaldanha.github.io/zendown/): Download e cache de arquivos depositados no Zenodo
-   [{zenstats}](https://rfsaldanha.github.io/zenstats/): Estatísticas de depósitos no Zenodo

##

```{r}
library(dplyr)
library(cranlogs)
library(ggplot2)

# Packages list
pkgs <- list(
  list(name = "nseq", start_date = "2024-05-31"),
  list(name = "zendown", start_date = "2024-04-12"),
  list(name = "zenstats", start_date = "2024-05-31"),
  list(name = "brpop", start_date = "2022-07-06"),
  list(name = "tidyrates", start_date = "2024-03-19"),
  list(name = "brclimr", start_date = "2023-03-07"),
  list(name = "microdatasus", start_date = "2024-06-16")
)

# Download stats
logs <- tibble()
for (p in 1:length(pkgs)) {
  tmp <- cran_downloads(
    packages = pkgs[[p]]$name,
    from = pkgs[[p]]$start_date,
    to = "last-day"
  )
  logs <- bind_rows(logs, tmp)
}
rm(tmp, p)

logs |>
  group_by(package) |>
  arrange(date) |>
  mutate(count = cumsum(count)) |>
  ungroup() |>
  ggplot(aes(x = date, y = count, colour = package)) +
  geom_line(linewidth = 1, alpha = .7) +
  theme_bw() +
  theme(legend.position = "bottom", legend.direction = "horizontal") +
  labs(x = "Date", y = "Cumulative downloads", colour = "")
```

##  {.big_text .center data-menu-title="{Obrigado!}"}

::: big_text
Obrigado!

raphael.saldanha@fiocruz.br

https://rfsaldanha.github.io
:::